(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[579],{77953:function(e,r,n){Promise.resolve().then(n.bind(n,22646))},22646:function(e,r,n){"use strict";n.r(r),n.d(r,{default:function(){return B}});var s,t,i,l,a=n(57437),c=n(2265),d=n(16593),o=n(31691),h=n(19978),x=n(46387),j=n(2069),Z=n(41327),u=n(10020),m=n(65298),v=n(42187),y=n(22095),p=n(53410),b=n(70208),g=n(32281),f=n(54301),w=n(52988),C=n(59469),_=n(67571),E=n(91991),k=n(36476),W=n(53392),P=n(79507),S=n(77468),I=n(67208),N=n(36137),A=n(9026),D=n(97404),O=n(87735),R=n(56410),T=n(47990);function B(){var e;let r=(0,o.Z)(),[n,s]=(0,c.useState)(1),[t,i]=(0,c.useState)(null),[l,B]=(0,c.useState)(""),[H,M]=(0,c.useState)(!1),[U,z]=(0,c.useState)("approved"),[L,F]=(0,c.useState)(""),V=(n-1)*10,{data:q,isLoading:G,refetch:Y}=(0,d.a)({queryKey:["reports",n,l],queryFn:async()=>{let e=new URLSearchParams({offset:V.toString(),limit:"10"});return l&&e.append("status",l),(await T.Z.get("".concat("http://localhost:9999","/api/story/admin/reports?").concat(e),{withCredentials:!0})).data}}),J=e=>{switch(e){case"pending":return"warning";case"reviewing":return"info";case"approved":return"error";case"rejected":return"success";default:return"default"}},K=e=>{switch(e){case"pending":return"대기중";case"reviewing":return"검토중";case"approved":return"승인됨";case"rejected":return"반려됨";default:return e}},Q=e=>{i(e)},X=()=>{i(null)},$=e=>{i(e),M(!0),z("approved"),F("")},ee=async()=>{if(t)try{await T.Z.put("".concat("http://localhost:9999","/api/story/admin/reports/").concat(t.id,"/review"),{status:U,admin_comment:L},{withCredentials:!0}),M(!1),i(null),Y()}catch(e){console.error("신고 검토 실패:",e)}},er=q?Math.ceil(q.total/10):0;return G?(0,a.jsx)(h.Z,{maxWidth:"lg",sx:{mt:4,mb:4},children:(0,a.jsx)(x.Z,{children:"로딩 중..."})}):(0,a.jsxs)(h.Z,{maxWidth:"lg",sx:{mt:4,mb:4},children:[(0,a.jsxs)(j.Z,{sx:{mb:4},children:[(0,a.jsx)(x.Z,{variant:"h4",component:"h1",gutterBottom:!0,sx:{fontWeight:"bold",color:"dark"===r.palette.mode?"#A78BFA":"#7C3AED"},children:"신고 목록 관리"}),(0,a.jsxs)(j.Z,{sx:{mb:3,display:"flex",gap:2,alignItems:"center"},children:[(0,a.jsxs)(Z.Z,{size:"small",sx:{minWidth:120},children:[(0,a.jsx)(u.Z,{children:"상태 필터"}),(0,a.jsxs)(m.Z,{value:l,label:"상태 필터",onChange:e=>B(e.target.value),children:[(0,a.jsx)(v.Z,{value:"",children:"전체"}),(0,a.jsx)(v.Z,{value:"pending",children:"대기중"}),(0,a.jsx)(v.Z,{value:"reviewing",children:"검토중"}),(0,a.jsx)(v.Z,{value:"approved",children:"승인됨"}),(0,a.jsx)(v.Z,{value:"rejected",children:"반려됨"})]})]}),(0,a.jsxs)(x.Z,{variant:"body2",color:"text.secondary",children:["총 ",(null==q?void 0:q.total)||0,"건의 신고"]})]}),(0,a.jsx)(y.Z,{component:p.Z,sx:{mb:3},children:(0,a.jsxs)(b.Z,{children:[(0,a.jsx)(g.Z,{children:(0,a.jsxs)(f.Z,{children:[(0,a.jsx)(w.Z,{children:"신고 ID"}),(0,a.jsx)(w.Z,{children:"게시글 제목"}),(0,a.jsx)(w.Z,{children:"신고 사유"}),(0,a.jsx)(w.Z,{children:"신고자"}),(0,a.jsx)(w.Z,{children:"상태"}),(0,a.jsx)(w.Z,{children:"신고일"}),(0,a.jsx)(w.Z,{children:"작업"})]})}),(0,a.jsx)(C.Z,{children:null==q?void 0:null===(e=q.reports)||void 0===e?void 0:e.map(e=>(0,a.jsxs)(f.Z,{children:[(0,a.jsx)(w.Z,{children:e.id}),(0,a.jsx)(w.Z,{children:(0,a.jsx)(x.Z,{variant:"body2",sx:{maxWidth:200},noWrap:!0,children:e.story.title})}),(0,a.jsx)(w.Z,{children:e.reason}),(0,a.jsx)(w.Z,{children:e.reporter.nickname}),(0,a.jsx)(w.Z,{children:(0,a.jsx)(_.Z,{label:K(e.status),color:J(e.status),size:"small"})}),(0,a.jsx)(w.Z,{children:(0,O.WU)(new Date(e.created_at),"yyyy-MM-dd HH:mm",{locale:R.ko})}),(0,a.jsx)(w.Z,{children:(0,a.jsxs)(j.Z,{sx:{display:"flex",gap:1},children:[(0,a.jsx)(E.Z,{size:"small",variant:"outlined",onClick:()=>Q(e),children:"상세"}),"pending"===e.status&&(0,a.jsx)(E.Z,{size:"small",variant:"contained",color:"primary",onClick:()=>$(e),children:"검토"})]})})]},e.id))})]})}),er>1&&(0,a.jsx)(j.Z,{sx:{display:"flex",justifyContent:"center"},children:(0,a.jsx)(k.Z,{count:er,page:n,onChange:(e,r)=>s(r),color:"primary"})})]}),(0,a.jsxs)(W.Z,{open:!!(t&&!H),onClose:X,maxWidth:"md",fullWidth:!0,children:[(0,a.jsx)(P.Z,{children:"신고 상세 정보"}),(0,a.jsx)(S.Z,{children:t&&(0,a.jsxs)(j.Z,{sx:{mt:2},children:[(0,a.jsx)(I.Z,{sx:{mb:2},children:(0,a.jsxs)(N.Z,{children:[(0,a.jsx)(x.Z,{variant:"h6",gutterBottom:!0,children:"신고 정보"}),(0,a.jsxs)(j.Z,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:2},children:[(0,a.jsxs)(j.Z,{children:[(0,a.jsx)(x.Z,{variant:"body2",color:"text.secondary",children:"신고 ID"}),(0,a.jsx)(x.Z,{variant:"body1",children:t.id})]}),(0,a.jsxs)(j.Z,{children:[(0,a.jsx)(x.Z,{variant:"body2",color:"text.secondary",children:"상태"}),(0,a.jsx)(_.Z,{label:K(t.status),color:J(t.status),size:"small"})]}),(0,a.jsxs)(j.Z,{children:[(0,a.jsx)(x.Z,{variant:"body2",color:"text.secondary",children:"신고 사유"}),(0,a.jsx)(x.Z,{variant:"body1",children:t.reason})]}),(0,a.jsxs)(j.Z,{children:[(0,a.jsx)(x.Z,{variant:"body2",color:"text.secondary",children:"신고자"}),(0,a.jsx)(x.Z,{variant:"body1",children:t.reporter.nickname})]})]}),t.custom_reason&&(0,a.jsxs)(j.Z,{sx:{mt:2},children:[(0,a.jsx)(x.Z,{variant:"body2",color:"text.secondary",children:"상세 사유"}),(0,a.jsx)(x.Z,{variant:"body1",children:t.custom_reason})]})]})}),(0,a.jsx)(I.Z,{sx:{mb:2},children:(0,a.jsxs)(N.Z,{children:[(0,a.jsx)(x.Z,{variant:"h6",gutterBottom:!0,children:"신고된 게시글"}),(0,a.jsxs)(j.Z,{sx:{mb:2},children:[(0,a.jsx)(x.Z,{variant:"body2",color:"text.secondary",children:"제목"}),(0,a.jsx)(x.Z,{variant:"body1",children:t.story.title})]}),(0,a.jsxs)(j.Z,{sx:{mb:2},children:[(0,a.jsx)(x.Z,{variant:"body2",color:"text.secondary",children:"작성자"}),(0,a.jsx)(x.Z,{variant:"body1",children:t.story.author})]}),(0,a.jsxs)(j.Z,{sx:{mb:2},children:[(0,a.jsx)(x.Z,{variant:"body2",color:"text.secondary",children:"카테고리"}),(0,a.jsx)(x.Z,{variant:"body1",children:t.story.category})]}),(0,a.jsxs)(j.Z,{children:[(0,a.jsx)(x.Z,{variant:"body2",color:"text.secondary",children:"내용 미리보기"}),(0,a.jsx)(x.Z,{variant:"body1",children:t.story.content})]})]})}),t.admin_comment&&(0,a.jsx)(I.Z,{children:(0,a.jsxs)(N.Z,{children:[(0,a.jsx)(x.Z,{variant:"h6",gutterBottom:!0,children:"관리자 검토 의견"}),(0,a.jsx)(x.Z,{variant:"body1",children:t.admin_comment}),t.reviewer&&(0,a.jsx)(j.Z,{sx:{mt:1},children:(0,a.jsxs)(x.Z,{variant:"body2",color:"text.secondary",children:["검토자: ",t.reviewer.nickname]})}),t.reviewed_at&&(0,a.jsx)(j.Z,{sx:{mt:1},children:(0,a.jsxs)(x.Z,{variant:"body2",color:"text.secondary",children:["검토일시: ",(0,O.WU)(new Date(t.reviewed_at),"yyyy-MM-dd HH:mm",{locale:R.ko})]})})]})})]})}),(0,a.jsx)(A.Z,{children:(0,a.jsx)(E.Z,{onClick:X,children:"닫기"})})]}),(0,a.jsxs)(W.Z,{open:H,onClose:()=>M(!1),maxWidth:"sm",fullWidth:!0,children:[(0,a.jsx)(P.Z,{children:"신고 검토"}),(0,a.jsx)(S.Z,{children:(0,a.jsxs)(j.Z,{sx:{mt:2},children:[(0,a.jsxs)(Z.Z,{fullWidth:!0,sx:{mb:2},children:[(0,a.jsx)(u.Z,{children:"검토 결과"}),(0,a.jsxs)(m.Z,{value:U,label:"검토 결과",onChange:e=>z(e.target.value),children:[(0,a.jsx)(v.Z,{value:"approved",children:"승인 (조치 필요)"}),(0,a.jsx)(v.Z,{value:"rejected",children:"반려 (조치 불필요)"})]})]}),(0,a.jsx)(D.Z,{fullWidth:!0,multiline:!0,rows:4,label:"관리자 의견",value:L,onChange:e=>F(e.target.value),placeholder:"검토 의견을 입력해주세요..."})]})}),(0,a.jsxs)(A.Z,{children:[(0,a.jsx)(E.Z,{onClick:()=>M(!1),children:"취소"}),(0,a.jsx)(E.Z,{onClick:ee,variant:"contained",color:"primary",children:"검토 완료"})]})]})]})}(s=i||(i={})).PENDING="pending",s.REVIEWING="reviewing",s.APPROVED="approved",s.REJECTED="rejected",(t=l||(l={})).SPAM="스팸/도배",t.ABUSE="욕설/비방",t.ADULT_CONTENT="음란물/성적 콘텐츠",t.VIOLENCE="폭력적 콘텐츠",t.FALSE_INFO="허위 정보",t.COPYRIGHT="저작권 침해",t.PRIVACY="개인정보 노출",t.OTHER="기타"},47990:function(e,r,n){"use strict";var s=n(83464);let t=s.Z.create({baseURL:"http://localhost:9999",withCredentials:!0});t.interceptors.request.use(e=>e,e=>Promise.reject(e)),t.interceptors.response.use(e=>e,async e=>{var r;let n=e.config;if("/api/auth/refresh"===n.url)return window.location.href="/login",Promise.reject(e);if((null===(r=e.response)||void 0===r?void 0:r.status)===401&&!n._retry){n._retry=!0;try{return await s.Z.post("".concat("http://localhost:9999","/api/auth/refresh"),{},{withCredentials:!0,headers:{"Content-Type":"application/json"}}),t(n)}catch(e){return window.location.href="/login",Promise.reject(e)}}return Promise.reject(e)}),r.Z=t}},function(e){e.O(0,[5152,4419,1991,1547,6593,455,2472,7404,6931,7571,6476,8921,2321,963,2971,2117,1744],function(){return e(e.s=77953)}),_N_E=e.O()}]);