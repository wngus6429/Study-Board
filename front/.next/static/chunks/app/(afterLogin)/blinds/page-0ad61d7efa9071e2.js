(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1216],{87300:function(e,n,t){Promise.resolve().then(t.bind(t,62657))},62657:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return N}});var s=t(57437),r=t(2265),i=t(2069),l=t(35389),a=t(19978),d=t(46387),o=t(53410),c=t(91991),u=t(8350),h=t(15273),x=t(87055),m=t(67051),p=t(86247),j=t(59832),f=t(36476),Z=t(53392),y=t(79507),g=t(77468),v=t(97404),b=t(9026),U=t(8444),C=t(82279),w=t(76672),I=t(29886),S=t(14759),k=t(30275),W=t(29827),P=t(16593),_=t(21770),F=t(99376),E=t(80605),L=t(39795),q=t(56410),B=t(32574),D=t(14534);function N(){let e=(0,F.useRouter)(),{data:n,status:t}=(0,E.useSession)(),N=(0,W.NL)(),{setBlindUsers:A}=(0,D.L)(),[K,Q]=(0,r.useState)(1),[H,O]=(0,r.useState)(!1),[R,$]=(0,r.useState)(""),[z,T]=(0,r.useState)({open:!1,message:"",severity:"success"}),[G,J]=(0,r.useState)(!1),[M,V]=(0,r.useState)(null),{data:X,isLoading:Y,error:ee}=(0,P.a)({queryKey:["blindUsers",K],queryFn:()=>(0,B.Lc)(K,10),enabled:!!(null==n?void 0:n.user)&&"authenticated"===t}),en=(0,_.D)({mutationFn:B.$f,onSuccess:e=>{N.invalidateQueries({queryKey:["blindUsers"]}),O(!1),$(""),T({open:!0,message:"사용자를 블라인드 목록에 추가했습니다.",severity:"success"})},onError:e=>{var n,t;T({open:!0,message:(null===(t=e.response)||void 0===t?void 0:null===(n=t.data)||void 0===n?void 0:n.message)||"블라인드 추가에 실패했습니다.",severity:"error"})}}),et=(0,_.D)({mutationFn:B.tf,onSuccess:()=>{N.invalidateQueries({queryKey:["blindUsers"]}),T({open:!0,message:"블라인드를 해제했습니다.",severity:"success"})},onError:e=>{var n,t;T({open:!0,message:(null===(t=e.response)||void 0===t?void 0:null===(n=t.data)||void 0===n?void 0:n.message)||"블라인드 해제에 실패했습니다.",severity:"error"})}});if((0,r.useEffect)(()=>{(null==X?void 0:X.items)&&A(X.items)},[null==X?void 0:X.items,A]),"loading"===t)return(0,s.jsx)(i.Z,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"80vh",children:(0,s.jsx)(l.Z,{})});if(!(null==n?void 0:n.user))return e.push("/login"),null;let es=e=>(0,L.Q)(new Date(e),{addSuffix:!0,locale:q.ko}),er=(e,n)=>{V({id:e,nickname:n}),J(!0)},ei=()=>{J(!1),V(null)},el=()=>{T({...z,open:!1})};return ee?(0,s.jsx)(a.Z,{maxWidth:"md",sx:{mt:4},children:(0,s.jsx)(d.Z,{color:"error",children:"블라인드 목록을 불러오는 중 오류가 발생했습니다."})}):(0,s.jsxs)(a.Z,{maxWidth:"md",sx:{mt:4,mb:4},children:[(0,s.jsxs)(o.Z,{sx:{p:3},children:[(0,s.jsxs)(i.Z,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,children:[(0,s.jsx)(d.Z,{variant:"h4",fontWeight:"bold",children:"블라인드 관리"}),(0,s.jsx)(c.Z,{variant:"contained",startIcon:(0,s.jsx)(I.Z,{}),onClick:()=>O(!0),color:"primary",children:"사용자 블라인드"})]}),(0,s.jsx)(d.Z,{variant:"body2",color:"text.secondary",sx:{mb:2},children:'블라인드된 사용자의 게시글과 댓글은 "블라인드된 사용자입니다."로 표시됩니다.'}),(0,s.jsx)(u.Z,{sx:{mb:2}}),Y?(0,s.jsx)(i.Z,{display:"flex",justifyContent:"center",py:5,children:(0,s.jsx)(l.Z,{})}):X&&0!==X.items.length?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h.Z,{children:X.items.map((e,n)=>(0,s.jsxs)(r.Fragment,{children:[(0,s.jsxs)(x.ZP,{children:[(0,s.jsx)(m.Z,{primary:(0,s.jsx)(d.Z,{variant:"body1",fontWeight:"medium",children:e.targetUser.nickname}),secondary:(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(d.Z,{variant:"caption",color:"text.secondary",children:["블라인드 시간: ",es(e.createdAt)]})})}),(0,s.jsx)(p.Z,{children:(0,s.jsx)(j.Z,{edge:"end","aria-label":"블라인드 해제",onClick:()=>er(e.id,e.targetUser.nickname),color:"error",children:(0,s.jsx)(w.Z,{})})})]}),n<X.items.length-1&&(0,s.jsx)(u.Z,{})]},e.id))}),X.totalPages>1&&(0,s.jsx)(i.Z,{display:"flex",justifyContent:"center",mt:3,children:(0,s.jsx)(f.Z,{count:X.totalPages,page:K,onChange:(e,n)=>{Q(n)},color:"primary"})})]}):(0,s.jsx)(i.Z,{py:5,textAlign:"center",children:(0,s.jsx)(d.Z,{color:"text.secondary",children:"블라인드된 사용자가 없습니다."})})]}),(0,s.jsxs)(Z.Z,{open:H,onClose:()=>O(!1),maxWidth:"sm",fullWidth:!0,children:[(0,s.jsx)(y.Z,{children:"사용자 블라인드"}),(0,s.jsxs)(g.Z,{children:[(0,s.jsx)(d.Z,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"블라인드하려는 사용자의 닉네임을 입력해주세요."}),(0,s.jsx)(v.Z,{autoFocus:!0,margin:"dense",label:"닉네임",type:"text",fullWidth:!0,variant:"outlined",value:R,onChange:e=>$(e.target.value),placeholder:"예: testuser"})]}),(0,s.jsxs)(b.Z,{children:[(0,s.jsx)(c.Z,{onClick:()=>O(!1),children:"취소"}),(0,s.jsx)(c.Z,{onClick:()=>{if(!R.trim()){T({open:!0,message:"닉네임을 입력해주세요.",severity:"error"});return}en.mutate({targetUserNickname:R.trim()})},variant:"contained",disabled:en.isPending,children:en.isPending?"추가 중...":"블라인드"})]})]}),(0,s.jsxs)(Z.Z,{open:G,onClose:ei,maxWidth:"sm",fullWidth:!0,children:[(0,s.jsxs)(y.Z,{sx:{display:"flex",alignItems:"center",gap:1,color:"error.main",fontWeight:"bold"},children:[(0,s.jsx)(k.Z,{color:"error"}),"블라인드 해제 확인"]}),(0,s.jsx)(g.Z,{sx:{pt:2},children:(0,s.jsxs)(i.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"center",gap:2,py:2},children:[(0,s.jsx)(S.Z,{sx:{fontSize:48,color:"text.secondary"}}),(0,s.jsxs)(d.Z,{variant:"body1",color:"text.primary",textAlign:"center",children:[(0,s.jsxs)("strong",{children:['"',null==M?void 0:M.nickname,'"']})," 사용자의 블라인드를 해제하시겠습니까?"]}),(0,s.jsx)(d.Z,{variant:"body2",color:"text.secondary",textAlign:"center",children:"해제 후 해당 사용자의 게시글과 댓글이 다시 표시됩니다."})]})}),(0,s.jsxs)(b.Z,{sx:{px:3,pb:3},children:[(0,s.jsx)(c.Z,{onClick:ei,variant:"outlined",sx:{minWidth:80},children:"취소"}),(0,s.jsx)(c.Z,{onClick:()=>{M&&(et.mutate(M.id),J(!1),V(null))},variant:"contained",color:"error",startIcon:(0,s.jsx)(w.Z,{}),sx:{minWidth:80},children:"해제"})]})]}),(0,s.jsx)(U.Z,{open:z.open,autoHideDuration:4e3,onClose:el,children:(0,s.jsx)(C.Z,{onClose:el,severity:z.severity,sx:{width:"100%"},children:z.message})})]})}},47990:function(e,n,t){"use strict";var s=t(83464);let r=s.Z.create({baseURL:"http://localhost:9999",withCredentials:!0});r.interceptors.request.use(e=>e,e=>Promise.reject(e)),r.interceptors.response.use(e=>e,async e=>{var n;let t=e.config;if("/api/auth/refresh"===t.url)return window.location.href="/login",Promise.reject(e);if((null===(n=e.response)||void 0===n?void 0:n.status)===401&&!t._retry){t._retry=!0;try{return await s.Z.post("".concat("http://localhost:9999","/api/auth/refresh"),{},{withCredentials:!0,headers:{"Content-Type":"application/json"}}),r(t)}catch(e){return window.location.href="/login",Promise.reject(e)}}return Promise.reject(e)}),n.Z=r},32574:function(e,n,t){"use strict";t.d(n,{$f:function(){return r},Lc:function(){return i},tf:function(){return l}});var s=t(47990);let r=async e=>(await s.Z.post("".concat("http://localhost:9999","/api/blinds"),e,{withCredentials:!0})).data,i=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;return(await s.Z.get("".concat("http://localhost:9999","/api/blinds"),{params:{page:e,limit:n},withCredentials:!0})).data},l=async e=>{await s.Z.delete("".concat("http://localhost:9999","/api/blinds/").concat(e),{withCredentials:!0})}},14534:function(e,n,t){"use strict";t.d(n,{L:function(){return s}});let s=(0,t(3011).U)((e,n)=>({blindUsers:[],blindedUserIds:new Set,setBlindUsers:n=>e({blindUsers:n,blindedUserIds:new Set(n.map(e=>e.targetUserId))}),addBlindUser:n=>e(e=>{let t=[...e.blindUsers,n],s=new Set(e.blindedUserIds);return s.add(n.targetUserId),{blindUsers:t,blindedUserIds:s}}),removeBlindUser:n=>e(e=>{let t=e.blindUsers.find(e=>e.id===n),s=e.blindUsers.filter(e=>e.id!==n),r=new Set(e.blindedUserIds);return t&&r.delete(t.targetUserId),{blindUsers:s,blindedUserIds:r}}),isUserBlinded:e=>n().blindedUserIds.has(e),clearBlindUsers:()=>e({blindUsers:[],blindedUserIds:new Set})}))}},function(e){e.O(0,[5152,4419,1991,1547,6593,455,2472,7404,9631,605,7037,6931,1256,6476,8921,9795,8444,232,2971,2117,1744],function(){return e(e.s=87300)}),_N_E=e.O()}]);